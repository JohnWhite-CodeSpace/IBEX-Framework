<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>API Reference &#8212; IBEX Framework 1.2 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=27fed22d" />
    <script src="_static/documentation_options.js?v=61243dd2"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="IBEX Framework" href="index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="api-reference">
<h1>API Reference<a class="headerlink" href="#api-reference" title="Link to this heading">¶</a></h1>
<section id="module-IBEX_Module.TensorCreator">
<span id="tensorcreator"></span><h2>TensorCreator<a class="headerlink" href="#module-IBEX_Module.TensorCreator" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="IBEX_Module.TensorCreator.TensorCreator">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">IBEX_Module.TensorCreator.</span></span><span class="sig-name descname"><span class="pre">TensorCreator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/IBEX_Module/TensorCreator.html#TensorCreator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#IBEX_Module.TensorCreator.TensorCreator" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<hr class="docutils" />
<p>Class responsible for constructing structured PyTorch tensors from raw IBEX
measurement data files.</p>
<p>The class traverses the IBEX raw data directory tree, loads event-level data
for individual energy channels, applies basic preprocessing steps
(including optional hexadecimal value translation), and combines the data
into channel-specific tensors saved in <code class="docutils literal notranslate"><span class="pre">.pt</span></code> format.</p>
<p>Tensor creation can be performed either for continuous orbital ranges or
for datasets split around the perigee change of the IBEX spacecraft.</p>
<dl class="py method">
<dt class="sig sig-object py" id="IBEX_Module.TensorCreator.TensorCreator.init_channel_tensors">
<span class="sig-name descname"><span class="pre">init_channel_tensors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">perigee_change</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/IBEX_Module/TensorCreator.html#TensorCreator.init_channel_tensors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#IBEX_Module.TensorCreator.TensorCreator.init_channel_tensors" title="Link to this definition">¶</a></dt>
<dd><p>Initialize multithreaded tensor creation for all energy channels.</p>
<p>The method spawns a separate worker thread for each energy channel and
generates channel-specific tensors according to the configured
instruction file and directory boundaries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>perigee_change</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, tensor creation is performed across subfolders spanning
the perigee change of the IBEX spacecraft. If False, data are processed
within a continuous directory range.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If an unsupported instruction file is specified.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-IBEX_Module.TensorAnalyzer">
<span id="tensoranalyzer"></span><h2>TensorAnalyzer<a class="headerlink" href="#module-IBEX_Module.TensorAnalyzer" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="IBEX_Module.TensorAnalyzer.ChannelAnalyzer">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">IBEX_Module.TensorAnalyzer.</span></span><span class="sig-name descname"><span class="pre">ChannelAnalyzer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'MainConfig.yml'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/IBEX_Module/TensorAnalyzer.html#ChannelAnalyzer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#IBEX_Module.TensorAnalyzer.ChannelAnalyzer" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<hr class="docutils" />
<p>Class responsible for preprocessing IBEX ENA data based on high-quality acquisition
time intervals specified in instruction files (HiCullGoodTimes.txt and LoGoodTimes.txt).</p>
<p>The class provides three main data preprocessing modes:</p>
<ol class="arabic simple">
<li><p>Extraction of raw ENA events satisfying quality criteria and saving them as PyTorch tensors.</p></li>
<li><p>Calculation of good data sums (total number of ENA detections per valid time interval).</p></li>
<li><p>Aggregation of ENA detection features by computing physically meaningful statistical
descriptors (means, circular means, and standard deviations).</p></li>
</ol>
<p>The preprocessing is performed independently for each IBEX-Hi and IBEX-Lo energy channel.</p>
<p class="rubric">Notes</p>
<p>Some methods of this class are marked as deprecated and preserved only as
legacy artefacts from earlier versions of the analysis pipeline. They are
not used in the current implementation but remain available for reference
and reproducibility of previous results.</p>
<hr class="docutils" />
<dl class="py method">
<dt class="sig sig-object py" id="IBEX_Module.TensorAnalyzer.ChannelAnalyzer.analyze">
<span class="sig-name descname"><span class="pre">analyze</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_path_prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_path_suffix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/IBEX_Module/TensorAnalyzer.html#ChannelAnalyzer.analyze"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#IBEX_Module.TensorAnalyzer.ChannelAnalyzer.analyze" title="Link to this definition">¶</a></dt>
<dd><div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 1.1: </span>Deprecated end-to-end analysis routine from an earlier version of the
ChannelAnalyzer class. This method is retained for archival and reference
purposes only and is not used in the current data processing pipeline.</p>
</div>
<p>Perform correlation analysis between all energy channels and generate
correlation matrices and heatmaps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> (<em>str</em>) – Correlation method identifier (<code class="docutils literal notranslate"><span class="pre">'pearson'</span></code>, <code class="docutils literal notranslate"><span class="pre">'weighted_pearson'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'spearman'</span></code>, or <code class="docutils literal notranslate"><span class="pre">'MI'</span></code>).</p></li>
<li><p><strong>file_path_prefix</strong> (<em>str</em>) – Prefix of input file paths.</p></li>
<li><p><strong>file_path_suffix</strong> (<em>str</em>) – Suffix of input file paths.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="IBEX_Module.TensorAnalyzer.ChannelAnalyzer.init_analyzer_tensors">
<span class="sig-name descname"><span class="pre">init_analyzer_tensors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hi_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'hi_hex_channel'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lo_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'lo_hex_channel'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">option</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'save_good_data_sums'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/IBEX_Module/TensorAnalyzer.html#ChannelAnalyzer.init_analyzer_tensors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#IBEX_Module.TensorAnalyzer.ChannelAnalyzer.init_analyzer_tensors" title="Link to this definition">¶</a></dt>
<dd><p>Initialize multithreaded preprocessing of all IBEX energy channels.</p>
<p>Depending on the selected option, the method performs one of the supported
preprocessing procedures independently for each channel using a thread pool.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hi_name</strong> (<em>str</em><em>, </em><em>optional</em>) – Filename prefix for IBEX-Hi channel tensor files.</p></li>
<li><p><strong>lo_name</strong> (<em>str</em><em>, </em><em>optional</em>) – Filename prefix for IBEX-Lo channel tensor files.</p></li>
<li><p><strong>option</strong> (<em>str</em><em>, </em><em>optional</em>) – <p>Type of preprocessing to perform. Supported values are:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;save_raw_good_data&quot;</span></code> — extract and save raw filtered ENA events.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;save_good_data_sums&quot;</span></code> — compute and save ENA detection sums.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;aggregate_all_physical_features&quot;</span></code> — aggregate ENA features for global analysis.</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Exception</strong> – If an unsupported option value is provided.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="IBEX_Module.TensorAnalyzer.ChannelAnalyzer.load_data">
<span class="sig-name descname"><span class="pre">load_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/IBEX_Module/TensorAnalyzer.html#ChannelAnalyzer.load_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#IBEX_Module.TensorAnalyzer.ChannelAnalyzer.load_data" title="Link to this definition">¶</a></dt>
<dd><div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 1.1: </span>Deprecated I/O helper method retained from a previous version of the class.
File loading is no longer handled by this component.</p>
</div>
<p>Load numerical data from a text file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file_path</strong> (<em>str</em>) – Path to the input file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Loaded data array, or an empty array in case of an error.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="IBEX_Module.TensorAnalyzer.ChannelAnalyzer.mutual_information">
<span class="sig-name descname"><span class="pre">mutual_information</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/IBEX_Module/TensorAnalyzer.html#ChannelAnalyzer.mutual_information"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#IBEX_Module.TensorAnalyzer.ChannelAnalyzer.mutual_information" title="Link to this definition">¶</a></dt>
<dd><div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 1.1: </span>Deprecated legacy method retained for reference purposes. Mutual
information analysis is no longer part of the current processing workflow.</p>
</div>
<p>Estimate mutual information between two one-dimensional arrays.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.ndarray</em>) – First input array.</p></li>
<li><p><strong>y</strong> (<em>np.ndarray</em>) – Second input array.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Estimated mutual information value.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="IBEX_Module.TensorAnalyzer.ChannelAnalyzer.pearson_correlation">
<span class="sig-name descname"><span class="pre">pearson_correlation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/IBEX_Module/TensorAnalyzer.html#ChannelAnalyzer.pearson_correlation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#IBEX_Module.TensorAnalyzer.ChannelAnalyzer.pearson_correlation" title="Link to this definition">¶</a></dt>
<dd><div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 1.1: </span>This method is deprecated and preserved only as a legacy implementation
from a previous version of the ChannelAnalyzer class. It is no longer
used in the current analysis pipeline.</p>
</div>
<p>Compute the Pearson correlation coefficient between two one-dimensional arrays.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.ndarray</em>) – First input array.</p></li>
<li><p><strong>y</strong> (<em>np.ndarray</em>) – Second input array.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Pearson correlation coefficient.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="IBEX_Module.TensorAnalyzer.ChannelAnalyzer.spearman_correlation">
<span class="sig-name descname"><span class="pre">spearman_correlation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/IBEX_Module/TensorAnalyzer.html#ChannelAnalyzer.spearman_correlation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#IBEX_Module.TensorAnalyzer.ChannelAnalyzer.spearman_correlation" title="Link to this definition">¶</a></dt>
<dd><div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 1.1: </span>Legacy method retained for backward compatibility with older analysis
scripts. Not used in the current version of the pipeline.</p>
</div>
<p>Compute the Spearman rank correlation coefficient.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.ndarray</em>) – First input array.</p></li>
<li><p><strong>y</strong> (<em>np.ndarray</em>) – Second input array.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Spearman rank correlation coefficient.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="IBEX_Module.TensorAnalyzer.ChannelAnalyzer.weighted_pearson_correlation">
<span class="sig-name descname"><span class="pre">weighted_pearson_correlation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_durations_x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_durations_y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/IBEX_Module/TensorAnalyzer.html#ChannelAnalyzer.weighted_pearson_correlation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#IBEX_Module.TensorAnalyzer.ChannelAnalyzer.weighted_pearson_correlation" title="Link to this definition">¶</a></dt>
<dd><div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 1.1: </span>Deprecated weighted correlation method retained as a historical artefact
from an earlier analysis approach. It is not used in the current workflow.</p>
</div>
<p>Compute a weighted Pearson correlation coefficient using time durations as weights.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.ndarray</em>) – First input array.</p></li>
<li><p><strong>y</strong> (<em>np.ndarray</em>) – Second input array.</p></li>
<li><p><strong>time_durations_x</strong> (<em>np.ndarray</em>) – Weights associated with the first array.</p></li>
<li><p><strong>time_durations_y</strong> (<em>np.ndarray</em>) – Weights associated with the second array.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Weighted Pearson correlation coefficient.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-IBEX_Module.FileMerger">
<span id="filemerger"></span><h2>FileMerger<a class="headerlink" href="#module-IBEX_Module.FileMerger" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="IBEX_Module.FileMerger.FileMerger">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">IBEX_Module.FileMerger.</span></span><span class="sig-name descname"><span class="pre">FileMerger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/IBEX_Module/FileMerger.html#FileMerger"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#IBEX_Module.FileMerger.FileMerger" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<hr class="docutils" />
<p>Class responsible for merging preprocessed IBEX data files into unified,
channel-specific output files.</p>
<p>The class operates on data batches generated in earlier stages of the
analysis pipeline and combines them into single merged datasets. This
approach enables processing large data volumes while limiting system
resource usage, in particular RAM memory consumption.</p>
<hr class="docutils" />
<dl class="py method">
<dt class="sig sig-object py" id="IBEX_Module.FileMerger.FileMerger.merge_files">
<span class="sig-name descname"><span class="pre">merge_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">channel_num</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">15</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="_modules/IBEX_Module/FileMerger.html#FileMerger.merge_files"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#IBEX_Module.FileMerger.FileMerger.merge_files" title="Link to this definition">¶</a></dt>
<dd><p>Merge preprocessed IBEX data files into channel-specific merged datasets.</p>
<p>For each energy channel, the method loads partial data files defined in the
configuration, concatenates them vertically, and saves the merged result
to the output directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>channel_num</strong> (<em>int</em><em>, </em><em>optional</em>) – Upper bound of channel indices to process. Channels are iterated from
1 to <code class="docutils literal notranslate"><span class="pre">channel_num</span> <span class="pre">-</span> <span class="pre">1</span></code>. Default is 15 (corresponding to 14 channels).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary containing <code class="docutils literal notranslate"><span class="pre">return_code</span></code> and <code class="docutils literal notranslate"><span class="pre">error_message</span></code> in case
of an error. Returns <code class="docutils literal notranslate"><span class="pre">None</span></code> if all channels are merged successfully.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="IBEX_Module.FileMerger.FileMerger.write_log">
<span class="sig-name descname"><span class="pre">write_log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">return_code</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_message</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/IBEX_Module/FileMerger.html#FileMerger.write_log"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#IBEX_Module.FileMerger.FileMerger.write_log" title="Link to this definition">¶</a></dt>
<dd><p>Log an error message and return code to the execution terminal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>return_code</strong> (<em>int</em>) – Numeric code describing the error type.</p></li>
<li><p><strong>error_message</strong> (<em>str</em>) – Description of the encountered error.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="IBEX_Module.FileMerger.FileMerger.write_message">
<span class="sig-name descname"><span class="pre">write_message</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/IBEX_Module/FileMerger.html#FileMerger.write_message"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#IBEX_Module.FileMerger.FileMerger.write_message" title="Link to this definition">¶</a></dt>
<dd><p>Log a status or informational message to the execution terminal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>message</strong> (<em>str</em>) – Informational message to be logged.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-IBEX_Module.IBEX_NN">
<span id="ibex-nn"></span><h2>IBEX_NN<a class="headerlink" href="#module-IBEX_Module.IBEX_NN" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="IBEX_Module.IBEX_NN.RateAutoencoder">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">IBEX_Module.IBEX_NN.</span></span><span class="sig-name descname"><span class="pre">RateAutoencoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">14</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latent_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/IBEX_Module/IBEX_NN.html#RateAutoencoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#IBEX_Module.IBEX_NN.RateAutoencoder" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Autoencoder model for ENA detection rate vectors.</p>
<p>The model compresses 14-dimensional per-channel ENA rate vectors
into a low-dimensional latent representation and reconstructs
the original rates from it.</p>
<hr class="docutils" />
<dl class="py method">
<dt class="sig sig-object py" id="IBEX_Module.IBEX_NN.RateAutoencoder.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/IBEX_Module/IBEX_NN.html#RateAutoencoder.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#IBEX_Module.IBEX_NN.RateAutoencoder.forward" title="Link to this definition">¶</a></dt>
<dd><p>Forward pass through the autoencoder.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>torch.Tensor</em>) – Input tensor of shape <code class="docutils literal notranslate"><span class="pre">(batch_size,</span> <span class="pre">input_dim)</span></code>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>x_hat</strong> (<em>torch.Tensor</em>) – Reconstructed input tensor.</p></li>
<li><p><strong>z</strong> (<em>torch.Tensor</em>) – Latent representation.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="IBEX_Module.IBEX_NN.aggregate_events_to_bins">
<span class="sig-prename descclassname"><span class="pre">IBEX_Module.IBEX_NN.</span></span><span class="sig-name descname"><span class="pre">aggregate_events_to_bins</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">event_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_bin</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">600.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/IBEX_Module/IBEX_NN.html#aggregate_events_to_bins"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#IBEX_Module.IBEX_NN.aggregate_events_to_bins" title="Link to this definition">¶</a></dt>
<dd><p>Aggregate raw ENA events into fixed-duration time bins.</p>
<p>For each time interval, the function computes:</p>
<ul class="simple">
<li><p>ENA detection rates for all 14 energy channels,</p></li>
<li><p>auxiliary physical and geometrical conditions derived from
a reference channel.</p></li>
</ul>
<p>Time bins with missing data in any channel are discarded.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>event_data</strong> (<em>dict</em><em>[</em><em>int</em><em>, </em><em>torch.Tensor</em><em>]</em>) – Dictionary mapping channel indices to event-level tensors.</p></li>
<li><p><strong>time_bin</strong> (<em>float</em><em>, </em><em>optional</em>) – Width of the time bin in seconds. Default is 600 s.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>rates</strong> (<em>np.ndarray</em>) – Array of shape <code class="docutils literal notranslate"><span class="pre">(N_bins,</span> <span class="pre">14)</span></code> containing ENA detection rates
for all energy channels.</p></li>
<li><p><strong>conditions</strong> (<em>np.ndarray</em>) – Array of shape <code class="docutils literal notranslate"><span class="pre">(N_bins,</span> <span class="pre">N_conditions)</span></code> containing aggregated
physical and geometrical features per time bin.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="IBEX_Module.IBEX_NN.init_dataset_preparation_pipeline">
<span class="sig-prename descclassname"><span class="pre">IBEX_Module.IBEX_NN.</span></span><span class="sig-name descname"><span class="pre">init_dataset_preparation_pipeline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regimes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">['BeforePerigeeChange',</span> <span class="pre">'AfterPerigeeChange']</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/IBEX_Module/IBEX_NN.html#init_dataset_preparation_pipeline"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#IBEX_Module.IBEX_NN.init_dataset_preparation_pipeline" title="Link to this definition">¶</a></dt>
<dd><p>Execute the full dataset preparation pipeline for multiple mission regimes.</p>
<p>For each regime, the function loads raw event data, aggregates it into
time bins, and saves the resulting datasets to disk.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>base_dir</strong> (<em>str</em>) – Base directory containing regime-specific input data.</p></li>
<li><p><strong>out_dir</strong> (<em>str</em>) – Output directory for aggregated datasets.</p></li>
<li><p><strong>regimes</strong> (<em>list</em><em> of </em><em>str</em><em>, </em><em>optional</em>) – List of regime identifiers to process.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="IBEX_Module.IBEX_NN.load_autoencoder_data">
<span class="sig-prename descclassname"><span class="pre">IBEX_Module.IBEX_NN.</span></span><span class="sig-name descname"><span class="pre">load_autoencoder_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">StandardScaler</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/IBEX_Module/IBEX_NN.html#load_autoencoder_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#IBEX_Module.IBEX_NN.load_autoencoder_data" title="Link to this definition">¶</a></dt>
<dd><p>Load and preprocess aggregated rate data for autoencoder training.</p>
<p>The preprocessing includes logarithmic transformation and per-channel
standardization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path</strong> (<em>str</em><em> or </em><em>pathlib.Path</em>) – Path to the directory containing <code class="docutils literal notranslate"><span class="pre">rates.npy</span></code>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>X</strong> (<em>np.ndarray</em>) – Preprocessed rate matrix.</p></li>
<li><p><strong>scaler</strong> (<em>StandardScaler</em>) – Fitted scaler used for standardization.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="IBEX_Module.IBEX_NN.load_event_data">
<span class="sig-prename descclassname"><span class="pre">IBEX_Module.IBEX_NN.</span></span><span class="sig-name descname"><span class="pre">load_event_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/IBEX_Module/IBEX_NN.html#load_event_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#IBEX_Module.IBEX_NN.load_event_data" title="Link to this definition">¶</a></dt>
<dd><p>Load raw IBEX event-level data for all energy channels.</p>
<p>The function loads preprocessed PyTorch tensors corresponding to
individual IBEX-Hi (channels 1–6) and IBEX-Lo (channels 7–14) energy channels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>base_dir</strong> (<em>str</em><em> or </em><em>pathlib.Path</em>) – Base directory containing <code class="docutils literal notranslate"><span class="pre">Hi_data</span></code> and <code class="docutils literal notranslate"><span class="pre">Lo_data</span></code> subdirectories.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary mapping global channel indices (1–14) to event tensors
of shape <code class="docutils literal notranslate"><span class="pre">(N_events,</span> <span class="pre">K_features)</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict[int, torch.Tensor]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>FileNotFoundError</strong> – If any required channel file is missing.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="IBEX_Module.IBEX_NN.make_dataloaders">
<span class="sig-prename descclassname"><span class="pre">IBEX_Module.IBEX_NN.</span></span><span class="sig-name descname"><span class="pre">make_dataloaders</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_frac</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.2</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">DataLoader</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">DataLoader</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/IBEX_Module/IBEX_NN.html#make_dataloaders"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#IBEX_Module.IBEX_NN.make_dataloaders" title="Link to this definition">¶</a></dt>
<dd><p>Create training and validation DataLoaders from a NumPy array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>np.ndarray</em>) – Input data matrix.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>optional</em>) – Batch size.</p></li>
<li><p><strong>val_frac</strong> (<em>float</em><em>, </em><em>optional</em>) – Fraction of data reserved for validation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>train_loader</strong> (<em>DataLoader</em>) – DataLoader for training.</p></li>
<li><p><strong>val_loader</strong> (<em>DataLoader</em>) – DataLoader for validation.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="IBEX_Module.IBEX_NN.per_channel_mse">
<span class="sig-prename descclassname"><span class="pre">IBEX_Module.IBEX_NN.</span></span><span class="sig-name descname"><span class="pre">per_channel_mse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/IBEX_Module/IBEX_NN.html#per_channel_mse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#IBEX_Module.IBEX_NN.per_channel_mse" title="Link to this definition">¶</a></dt>
<dd><p>Compute per-channel reconstruction mean squared error.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – Trained autoencoder model.</p></li>
<li><p><strong>X</strong> (<em>np.ndarray</em>) – Input data matrix.</p></li>
<li><p><strong>device</strong> (<em>str</em><em>, </em><em>optional</em>) – Computation device.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array of per-channel MSE values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="IBEX_Module.IBEX_NN.plot_per_channel_mse">
<span class="sig-prename descclassname"><span class="pre">IBEX_Module.IBEX_NN.</span></span><span class="sig-name descname"><span class="pre">plot_per_channel_mse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mse</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/IBEX_Module/IBEX_NN.html#plot_per_channel_mse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#IBEX_Module.IBEX_NN.plot_per_channel_mse" title="Link to this definition">¶</a></dt>
<dd><p>Plot per-channel reconstruction error.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mse</strong> (<em>np.ndarray</em>) – Per-channel MSE values.</p></li>
<li><p><strong>title</strong> (<em>str</em>) – Plot title.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="IBEX_Module.IBEX_NN.plot_training_history">
<span class="sig-prename descclassname"><span class="pre">IBEX_Module.IBEX_NN.</span></span><span class="sig-name descname"><span class="pre">plot_training_history</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">history</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/IBEX_Module/IBEX_NN.html#plot_training_history"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#IBEX_Module.IBEX_NN.plot_training_history" title="Link to this definition">¶</a></dt>
<dd><p>Plot training and validation loss curves.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>history</strong> (<em>dict</em>) – Dictionary containing loss histories.</p></li>
<li><p><strong>title</strong> (<em>str</em>) – Plot title.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="IBEX_Module.IBEX_NN.reconstruction_mse">
<span class="sig-prename descclassname"><span class="pre">IBEX_Module.IBEX_NN.</span></span><span class="sig-name descname"><span class="pre">reconstruction_mse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/IBEX_Module/IBEX_NN.html#reconstruction_mse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#IBEX_Module.IBEX_NN.reconstruction_mse" title="Link to this definition">¶</a></dt>
<dd><p>Compute global reconstruction mean squared error.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – Trained autoencoder model.</p></li>
<li><p><strong>X</strong> (<em>np.ndarray</em>) – Input data matrix.</p></li>
<li><p><strong>device</strong> (<em>str</em><em>, </em><em>optional</em>) – Computation device.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Global reconstruction MSE.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="IBEX_Module.IBEX_NN.save_aggregated_dataset">
<span class="sig-prename descclassname"><span class="pre">IBEX_Module.IBEX_NN.</span></span><span class="sig-name descname"><span class="pre">save_aggregated_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conditions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_bin</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/IBEX_Module/IBEX_NN.html#save_aggregated_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#IBEX_Module.IBEX_NN.save_aggregated_dataset" title="Link to this definition">¶</a></dt>
<dd><p>Save aggregated rate and condition datasets to disk.</p>
<p>The function stores NumPy arrays along with a JSON metadata file
describing the aggregation parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_dir</strong> (<em>str</em><em> or </em><em>pathlib.Path</em>) – Output directory for the aggregated dataset.</p></li>
<li><p><strong>rates</strong> (<em>np.ndarray</em>) – Array containing per-channel ENA detection rates.</p></li>
<li><p><strong>conditions</strong> (<em>np.ndarray</em>) – Array containing aggregated physical and geometrical features.</p></li>
<li><p><strong>time_bin</strong> (<em>float</em>) – Time bin width used during aggregation (in seconds).</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="IBEX_Module.IBEX_NN.train_autoencoder">
<span class="sig-prename descclassname"><span class="pre">IBEX_Module.IBEX_NN.</span></span><span class="sig-name descname"><span class="pre">train_autoencoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_loader</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataLoader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_loader</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataLoader</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_epochs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/IBEX_Module/IBEX_NN.html#train_autoencoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#IBEX_Module.IBEX_NN.train_autoencoder" title="Link to this definition">¶</a></dt>
<dd><p>Train an autoencoder model using mean squared error loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – Autoencoder model to be trained.</p></li>
<li><p><strong>train_loader</strong> (<em>DataLoader</em>) – DataLoader providing training samples.</p></li>
<li><p><strong>val_loader</strong> (<em>DataLoader</em><em>, </em><em>optional</em>) – DataLoader providing validation samples.</p></li>
<li><p><strong>n_epochs</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of training epochs.</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>optional</em>) – Learning rate.</p></li>
<li><p><strong>device</strong> (<em>str</em><em>, </em><em>optional</em>) – Device identifier (<code class="docutils literal notranslate"><span class="pre">'cpu'</span></code> or <code class="docutils literal notranslate"><span class="pre">'cuda'</span></code>).</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, training progress is printed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary containing training and validation loss histories.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">IBEX Framework</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-IBEX_Module.TensorCreator">TensorCreator</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-IBEX_Module.TensorAnalyzer">TensorAnalyzer</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-IBEX_Module.FileMerger">FileMerger</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-IBEX_Module.IBEX_NN">IBEX_NN</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">IBEX Framework</a></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="_sources/api.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>